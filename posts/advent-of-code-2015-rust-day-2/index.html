<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="theme" content="Chirpy v2.5.1"><meta name="generator" content="Jekyll v4.3.4" /><meta property="og:title" content="Learning Rust with Advent of Code - Day 2" /><meta name="author" content="David & Felipe" /><meta property="og:locale" content="en_US" /><meta name="description" content="2015 Day 2: An arithmetic problem involving the dimensions of presents, wrapping paper, and bows; an easy problem made trickier by not knowing how to convert strings or how to appease borrow chekers." /><meta property="og:description" content="2015 Day 2: An arithmetic problem involving the dimensions of presents, wrapping paper, and bows; an easy problem made trickier by not knowing how to convert strings or how to appease borrow chekers." /><link rel="canonical" href="http://hallofdreams.org/posts/advent-of-code-2015-rust-day-2/" /><meta property="og:url" content="http://hallofdreams.org/posts/advent-of-code-2015-rust-day-2/" /><meta property="og:site_name" content="Hall of Impossible Dreams" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-01-19T12:00:00-05:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Learning Rust with Advent of Code - Day 2" /><meta name="twitter:site" content="@thecog19" /><meta name="twitter:creator" content="@David & Felipe" /><meta name="google-site-verification" content="rOMa9oYHtFBq7U58IniOX1gggI6noWpOXoWBk-9hItk" /> <script type="application/ld+json"> {"description":"2015 Day 2: An arithmetic problem involving the dimensions of presents, wrapping paper, and bows; an easy problem made trickier by not knowing how to convert strings or how to appease borrow chekers.","@type":"BlogPosting","headline":"Learning Rust with Advent of Code - Day 2","url":"http://hallofdreams.org/posts/advent-of-code-2015-rust-day-2/","dateModified":"2021-01-19T12:00:00-05:00","datePublished":"2021-01-19T12:00:00-05:00","mainEntityOfPage":{"@type":"WebPage","@id":"http://hallofdreams.org/posts/advent-of-code-2015-rust-day-2/"},"author":{"@type":"Person","name":"David & Felipe"},"@context":"https://schema.org"}</script><title>Learning Rust with Advent of Code - Day 2 | Hall of Impossible Dreams</title><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"><link rel="preload" as="style" href="/assets/css/post.css"><link rel="stylesheet" href="/assets/css/post.css"><link rel="preload" as="style" href="/assets/css/lib/bootstrap-toc.min.css"><link rel="stylesheet" href="/assets/css/lib/bootstrap-toc.min.css" /> <script async src="https://www.googletagmanager.com/gtag/js?id=G-QGYEJ40C64"></script> <script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-QGYEJ40C64'); </script> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script async src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script async src="/assets/js/post.min.js"></script> <script defer src="/app.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column"><div id="nav-wrapper"><div id="profile-wrapper" class="d-flex flex-column"><div id="avatar" class="d-flex justify-content-center"> <a href="/" alt="avatar"> <img src="/assets/img/sample/avatar.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="profile-text mt-3"><div class="site-title"> <a href="/">Hall of Impossible Dreams</a></div><div class="site-subtitle font-italic">A repository of code, fiction, nonfiction, and poetry.</div></div></div><ul class="nav flex-column"><li class="nav-item d-flex justify-content-center "> <a href="/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item d-flex justify-content-center "> <a href="/tabs/categories/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item d-flex justify-content-center "> <a href="/tabs/tags/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item d-flex justify-content-center "> <a href="/tabs/archives/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item d-flex justify-content-center "> <a href="/tabs/about/" class="nav-link d-flex justify-content-center align-items-center w-100"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul></div><div class="sidebar-bottom d-flex flex-wrap justify-content-around mt-4"> <span id="mode-toggle-wrapper"> <i class="mode-toggle fas fa-sun" dark-mode-invisible></i> <i class="mode-toggle fas fa-moon" light-mode-invisible></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.mode != null) { if (this.mode == ModeToggle.DARK_MODE) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.mode != null) { if (self.mode == ModeToggle.DARK_MODE) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span> <span class="icon-border"></span> <a href="https://github.com/hallofdreams" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/thecog19" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['felipe.suero19','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>Learning Rust with Advent of Code - Day 2</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Learning Rust with Advent of Code - Day 2</h1><div class="post-meta text-muted d-flex flex-column"><div> Posted <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Tue, Jan 19, 2021, 12:00 PM -0500" > Jan 19, 2021 <i class="unloaded">2021-01-19T12:00:00-05:00</i> </span> <span class="author"> by David & Felipe </span></div></div><div class="post-content"><h3>Series Navigation</h3><li><a href="/posts/advent-of-code-2015-rust-day-1/">Learning Rust with Advent of Code - Day 1</a><li><b>Learning Rust with Advent of Code - Day 2</b><li><a href="/posts/advent-of-code-2015-rust-day-3/">Learning Rust with Advent of Code - Day 3</a><li><a href="/posts/advent-of-code-2015-rust-day-4/">Learning Rust with Advent of Code - Day 4</a><li><a href="/posts/advent-of-code-2015-rust-day-5/">Learning Rust with Advent of Code - Day 5</a><li><a href="/posts/advent-of-code-2015-rust-day-6/">Learning Rust with Advent of Code - Day 6</a></div><hr><div class="post-content"><div style="display:none;">2015 Day 2: An arithmetic problem involving the dimensions of presents, wrapping paper, and bows; an easy problem made trickier by not knowing how to convert strings or how to appease borrow chekers.</div><h1 id="day-2"><a href="https://www.adventofcode.com/2015/day/2">Day 2</a></h1><p>The problem: you’re given a list of dimensions of the form <code class="language-plaintext highlighter-rouge">lxwxh</code> for an integer length <code class="language-plaintext highlighter-rouge">l</code>, a width <code class="language-plaintext highlighter-rouge">w</code>, and a height <code class="language-plaintext highlighter-rouge">h</code>.</p><p>Part 1: Find the total of the surface area plus the area of the smallest side of each rectangular prism .</p><p>Part 2: Find the total of the smallest perimeter of any face plus the cubic volume on each rectangular prism.</p><hr /><h1 id="david">David</h1><p>Another very straightforward problem. Like day 1, the problem can be solved in a single pass through the file, with no need to store anything in memory. I was going to try <code class="language-plaintext highlighter-rouge">BufReader</code> to read the file line by line, but reading it, it seems that the file is just too short to be worth the extra overhead.</p><h2 id="attempt-00">Attempt 0.0</h2><div class="language-rust highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre><span class="k">use</span> <span class="nn">std</span><span class="p">::</span><span class="n">fs</span><span class="p">;</span>

<span class="k">fn</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
	<span class="k">let</span> <span class="n">file</span> <span class="o">=</span> <span class="s">"../Inputs/Day2Input.txt"</span><span class="p">;</span>
	<span class="k">let</span> <span class="n">input_raw</span><span class="p">:</span> <span class="nb">String</span> <span class="o">=</span> <span class="nn">fs</span><span class="p">::</span><span class="nf">read_to_string</span><span class="p">(</span><span class="n">file</span><span class="p">)</span><span class="nf">.unwrap</span><span class="p">();</span>
	<span class="k">let</span> <span class="n">lines</span> <span class="o">=</span> <span class="n">input_raw</span><span class="nf">.split</span><span class="p">(</span><span class="s">"/n"</span><span class="p">);</span>
	<span class="k">for</span> <span class="n">line</span> <span class="k">in</span> <span class="n">lines</span> <span class="p">{</span>
		<span class="k">let</span> <span class="k">mut</span> <span class="n">dims</span> <span class="o">=</span> <span class="n">line</span><span class="nf">.split</span><span class="p">(</span><span class="sc">'x'</span><span class="p">)</span><span class="py">.collect</span><span class="p">::</span><span class="o">&lt;</span><span class="nb">Vec</span><span class="o">&lt;&amp;</span><span class="nb">str</span><span class="o">&gt;&gt;</span><span class="p">();</span>
		<span class="nd">println!</span><span class="p">(</span><span class="s">"{:?}"</span><span class="p">,</span> <span class="n">dims</span><span class="p">);</span> <span class="c1">// To make sure the previous line worked.</span>
	<span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>Finished dev [unoptimized + debuginfo] target(s) in 0.00s
 Running `target/debug/day_1`
</pre></table></code></div></div><p>I was not expecting that to work the first time, but so far so good: I have for each line a vector of strings corresponding to the numerical dimensions. The next step is to turn those strings into unsigned integers.</p><h2 id="attempt-01">Attempt 0.1</h2><div class="language-rust highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre><span class="k">use</span> <span class="nn">std</span><span class="p">::</span><span class="n">fs</span><span class="p">;</span>

<span class="k">fn</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
	<span class="k">let</span> <span class="n">file</span> <span class="o">=</span> <span class="s">"../Inputs/Day2Input.txt"</span><span class="p">;</span>
	<span class="k">let</span> <span class="n">input_raw</span><span class="p">:</span> <span class="nb">String</span> <span class="o">=</span> <span class="nn">fs</span><span class="p">::</span><span class="nf">read_to_string</span><span class="p">(</span><span class="n">file</span><span class="p">)</span><span class="nf">.unwrap</span><span class="p">();</span>
	<span class="k">let</span> <span class="n">lines</span> <span class="o">=</span> <span class="n">input_raw</span><span class="nf">.lines</span><span class="p">();</span>
	<span class="k">for</span> <span class="n">line</span> <span class="k">in</span> <span class="n">lines</span> <span class="p">{</span>
		<span class="k">let</span> <span class="n">dims</span> <span class="o">=</span> <span class="n">line</span>
					<span class="nf">.split</span><span class="p">(</span><span class="sc">'x'</span><span class="p">)</span>
					<span class="py">.parse</span><span class="p">::</span><span class="o">&lt;</span><span class="nb">usize</span><span class="o">&gt;</span>
					<span class="py">.collect</span><span class="p">::</span><span class="o">&lt;</span><span class="nb">Vec</span><span class="o">&lt;</span><span class="n">_</span><span class="o">&gt;&gt;</span><span class="p">();</span>
		<span class="k">let</span> <span class="n">length</span> <span class="o">=</span> <span class="n">dims</span><span class="na">.0</span><span class="p">;</span>
		<span class="nd">println!</span><span class="p">(</span><span class="s">"Length: {}"</span><span class="p">,</span> <span class="n">length</span><span class="p">);</span>
	<span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>error[E0609]: no field `parse` on type `std::str::Split&lt;'_, char&gt;`

.parse::&lt;usize&gt;
^^^^^ unknown field
</pre></table></code></div></div><p>Okay, pretty sure the error there was that I forgot parentheses; the turbofish notation (<code class="language-plaintext highlighter-rouge">::&lt;...&gt;</code>) that specifies type is appended to the function name, but does not replace the parens for the arguments or lackthereof.</p><h2 id="attempt-02">Attempt 0.2</h2><div class="language-rust highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre><span class="k">use</span> <span class="nn">std</span><span class="p">::</span><span class="n">fs</span><span class="p">;</span>

<span class="k">fn</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
	<span class="k">let</span> <span class="n">file</span> <span class="o">=</span> <span class="s">"../Inputs/Day2Input.txt"</span><span class="p">;</span>
	<span class="k">let</span> <span class="n">input_raw</span><span class="p">:</span> <span class="nb">String</span> <span class="o">=</span> <span class="nn">fs</span><span class="p">::</span><span class="nf">read_to_string</span><span class="p">(</span><span class="n">file</span><span class="p">)</span><span class="nf">.unwrap</span><span class="p">();</span>
	<span class="k">let</span> <span class="n">lines</span> <span class="o">=</span> <span class="n">input_raw</span><span class="nf">.lines</span><span class="p">();</span>
	<span class="k">for</span> <span class="n">line</span> <span class="k">in</span> <span class="n">lines</span> <span class="p">{</span>
		<span class="k">let</span> <span class="n">dims</span> <span class="o">=</span> <span class="n">line</span>
					<span class="nf">.split</span><span class="p">(</span><span class="sc">'x'</span><span class="p">)</span>
					<span class="py">.parse</span><span class="p">::</span><span class="o">&lt;</span><span class="nb">usize</span><span class="o">&gt;</span><span class="p">()</span>
					<span class="py">.collect</span><span class="p">::</span><span class="o">&lt;</span><span class="nb">Vec</span><span class="o">&lt;</span><span class="n">_</span><span class="o">&gt;&gt;</span><span class="p">();</span>
		<span class="k">let</span> <span class="n">length</span> <span class="o">=</span> <span class="n">dims</span><span class="na">.0</span><span class="p">;</span>
		<span class="nd">println!</span><span class="p">(</span><span class="s">"Length: {}"</span><span class="p">,</span> <span class="n">length</span><span class="p">);</span>
	<span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>error[E0599]: no method named `parse` found for struct `std::str::Split&lt;'_, char&gt;` in the current scope

.parse::&lt;usize&gt;()
^^^^^ method not found in `std::str::Split&lt;'_, char&gt;`
</pre></table></code></div></div><p>Okay, it looks like I’m calling <code class="language-plaintext highlighter-rouge">.parse()</code> on an iterator; I need to map <code class="language-plaintext highlighter-rouge">parse</code> over the iterator before it’ll work, and then I can <code class="language-plaintext highlighter-rouge">collect</code> the results at the end. Oh, and lest I forget, <code class="language-plaintext highlighter-rouge">.parse()</code> returns a <code class="language-plaintext highlighter-rouge">Result</code>, not a value, so I need to <code class="language-plaintext highlighter-rouge">unwrap()</code> it before I continue.</p><h2 id="attempt-03">Attempt 0.3</h2><div class="language-rust highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre><span class="k">use</span> <span class="nn">std</span><span class="p">::</span><span class="n">fs</span><span class="p">;</span>

<span class="k">fn</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
	<span class="k">let</span> <span class="n">file</span> <span class="o">=</span> <span class="s">"../Inputs/Day2Input.txt"</span><span class="p">;</span>
	<span class="k">let</span> <span class="n">input_raw</span><span class="p">:</span> <span class="nb">String</span> <span class="o">=</span> <span class="nn">fs</span><span class="p">::</span><span class="nf">read_to_string</span><span class="p">(</span><span class="n">file</span><span class="p">)</span><span class="nf">.unwrap</span><span class="p">();</span>
	<span class="k">let</span> <span class="n">lines</span> <span class="o">=</span> <span class="n">input_raw</span><span class="nf">.lines</span><span class="p">();</span>
	<span class="k">for</span> <span class="n">line</span> <span class="k">in</span> <span class="n">lines</span> <span class="p">{</span>
		<span class="k">let</span> <span class="n">dims</span> <span class="o">=</span> <span class="n">line</span>
					<span class="nf">.split</span><span class="p">(</span><span class="sc">'x'</span><span class="p">)</span>
					<span class="nf">.map</span><span class="p">(|</span><span class="n">n</span><span class="p">|</span> <span class="n">n</span><span class="py">.parse</span><span class="p">::</span><span class="o">&lt;</span><span class="nb">usize</span><span class="o">&gt;</span><span class="p">()</span><span class="nf">.unwrap</span><span class="p">())</span>
					<span class="py">.collect</span><span class="p">::</span><span class="o">&lt;</span><span class="nb">Vec</span><span class="o">&lt;</span><span class="n">_</span><span class="o">&gt;&gt;</span><span class="p">();</span>
		<span class="k">let</span> <span class="n">length</span> <span class="o">=</span> <span class="n">dims</span><span class="na">.0</span><span class="p">;</span>
		<span class="nd">println!</span><span class="p">(</span><span class="s">"Length: {}"</span><span class="p">,</span> <span class="n">length</span><span class="p">);</span>
	<span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>error[E0609]: no field `0` on type `Vec&lt;usize&gt;`
let first = dims.0;
                 ^ unknown field
</pre></table></code></div></div><p>Interesting: it looks like <code class="language-plaintext highlighter-rouge">.0</code> works for tuples but not <code class="language-plaintext highlighter-rouge">Vec</code>. That’s an easy fix, at least.</p><h2 id="attempt-04">Attempt 0.4</h2><div class="language-rust highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre><span class="k">use</span> <span class="nn">std</span><span class="p">::</span><span class="n">fs</span><span class="p">;</span>

<span class="k">fn</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
	<span class="k">let</span> <span class="n">file</span> <span class="o">=</span> <span class="s">"../Inputs/Day2Input.txt"</span><span class="p">;</span>
	<span class="k">let</span> <span class="n">input_raw</span><span class="p">:</span> <span class="nb">String</span> <span class="o">=</span> <span class="nn">fs</span><span class="p">::</span><span class="nf">read_to_string</span><span class="p">(</span><span class="n">file</span><span class="p">)</span><span class="nf">.unwrap</span><span class="p">();</span>
	<span class="k">let</span> <span class="n">lines</span> <span class="o">=</span> <span class="n">input_raw</span><span class="nf">.lines</span><span class="p">();</span>
	<span class="k">for</span> <span class="n">line</span> <span class="k">in</span> <span class="n">lines</span> <span class="p">{</span>
		<span class="k">let</span> <span class="n">dims</span> <span class="o">=</span> <span class="n">line</span>
					<span class="nf">.split</span><span class="p">(</span><span class="sc">'x'</span><span class="p">)</span>
					<span class="nf">.map</span><span class="p">(|</span><span class="n">n</span><span class="p">|</span> <span class="n">n</span><span class="py">.parse</span><span class="p">::</span><span class="o">&lt;</span><span class="nb">usize</span><span class="o">&gt;</span><span class="p">()</span><span class="nf">.unwrap</span><span class="p">())</span>
					<span class="py">.collect</span><span class="p">::</span><span class="o">&lt;</span><span class="nb">Vec</span><span class="o">&lt;</span><span class="n">_</span><span class="o">&gt;&gt;</span><span class="p">();</span>
		<span class="k">let</span> <span class="n">length</span> <span class="o">=</span> <span class="n">dims</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
		<span class="nd">println!</span><span class="p">(</span><span class="s">"Length: {}"</span><span class="p">,</span> <span class="n">length</span><span class="p">);</span>
	<span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>Finished dev [unoptimized + debuginfo] target(s) in 0.27s
 Running `target/debug/day_1`
</pre></table></code></div></div><p>It works! I now can pass through the file, collecting each number in an array as I go; all I have to do is replace the <code class="language-plaintext highlighter-rouge">println!()</code> argument with the actual requirements of the problem. First, let me make sure that vector definition works the way I think it does.</p><h2 id="attempt-10">Attempt 1.0</h2><div class="language-rust highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre><td class="rouge-code"><pre><span class="k">use</span> <span class="nn">std</span><span class="p">::</span><span class="n">fs</span><span class="p">;</span>

<span class="k">fn</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
	<span class="k">let</span> <span class="n">file</span> <span class="o">=</span> <span class="s">"../Inputs/Day2Input.txt"</span><span class="p">;</span>
	<span class="k">let</span> <span class="n">input_raw</span><span class="p">:</span> <span class="nb">String</span> <span class="o">=</span> <span class="nn">fs</span><span class="p">::</span><span class="nf">read_to_string</span><span class="p">(</span><span class="n">file</span><span class="p">)</span><span class="nf">.unwrap</span><span class="p">();</span>
	<span class="k">let</span> <span class="n">lines</span> <span class="o">=</span> <span class="n">input_raw</span><span class="nf">.lines</span><span class="p">();</span>
	<span class="k">for</span> <span class="n">line</span> <span class="k">in</span> <span class="n">lines</span> <span class="p">{</span>
		<span class="k">let</span> <span class="n">dims</span> <span class="o">=</span> <span class="n">line</span>
					<span class="nf">.split</span><span class="p">(</span><span class="sc">'x'</span><span class="p">)</span>
					<span class="nf">.map</span><span class="p">(|</span><span class="n">n</span><span class="p">|</span> <span class="n">n</span><span class="py">.parse</span><span class="p">::</span><span class="o">&lt;</span><span class="nb">usize</span><span class="o">&gt;</span><span class="p">()</span><span class="nf">.unwrap</span><span class="p">())</span>
					<span class="py">.collect</span><span class="p">::</span><span class="o">&lt;</span><span class="nb">Vec</span><span class="o">&lt;</span><span class="n">_</span><span class="o">&gt;&gt;</span><span class="p">();</span>
		<span class="k">let</span> <span class="n">l</span> <span class="o">=</span> <span class="n">dims</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
		<span class="k">let</span> <span class="n">w</span> <span class="o">=</span> <span class="n">dims</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
		<span class="k">let</span> <span class="n">h</span> <span class="o">=</span> <span class="n">dims</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
		
		<span class="k">let</span> <span class="n">areas</span> <span class="o">=</span> <span class="nd">vec!</span><span class="p">[</span><span class="n">l</span><span class="o">*</span><span class="n">w</span><span class="p">,</span> <span class="n">l</span><span class="o">*</span><span class="n">h</span><span class="p">,</span> <span class="n">w</span><span class="o">*</span><span class="n">h</span><span class="p">];</span>
		<span class="k">let</span> <span class="n">perims</span> <span class="o">=</span> <span class="nd">vec!</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">l</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">w</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">l</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">h</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">w</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">h</span><span class="p">];</span>
	<span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>Finished dev [unoptimized + debuginfo] target(s) in 0.28s
</pre></table></code></div></div><p>I’m almost surprised that it’s able to infer the type of the vectors from the type of the components, given that you can easily make something larger than a <code class="language-plaintext highlighter-rouge">usize</code> by adding or multiplying two <code class="language-plaintext highlighter-rouge">usize</code> integers together; I know that this particular problem isn’t going to encounter such difficulties, but it’s something to keep in mind.</p><p>Next, I need to find the minimum area, minimum perimeter, and total area. Like other functions we’ve seen like <code class="language-plaintext highlighter-rouge">.map()</code>, <code class="language-plaintext highlighter-rouge">.min()</code> and <code class="language-plaintext highlighter-rouge">.sum()</code> both operate on iterators rather than vectors, so we’ll need to use <code class="language-plaintext highlighter-rouge">.into_iter()</code> again.</p><h2 id="attempt-11">Attempt 1.1</h2><div class="language-rust highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
</pre><td class="rouge-code"><pre><span class="k">use</span> <span class="nn">std</span><span class="p">::</span><span class="n">fs</span><span class="p">;</span>

<span class="k">fn</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
	<span class="k">let</span> <span class="n">file</span> <span class="o">=</span> <span class="s">"../Inputs/Day2Input.txt"</span><span class="p">;</span>
	<span class="k">let</span> <span class="n">input_raw</span><span class="p">:</span> <span class="nb">String</span> <span class="o">=</span> <span class="nn">fs</span><span class="p">::</span><span class="nf">read_to_string</span><span class="p">(</span><span class="n">file</span><span class="p">)</span><span class="nf">.unwrap</span><span class="p">();</span>
	<span class="k">let</span> <span class="n">lines</span> <span class="o">=</span> <span class="n">input_raw</span><span class="nf">.lines</span><span class="p">();</span>
	
	<span class="k">let</span> <span class="k">mut</span> <span class="n">part1</span><span class="p">:</span> <span class="nb">usize</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="k">let</span> <span class="k">mut</span> <span class="n">part2</span><span class="p">:</span> <span class="nb">usize</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="k">for</span> <span class="n">line</span> <span class="k">in</span> <span class="n">lines</span> <span class="p">{</span>
		<span class="k">let</span> <span class="n">dims</span> <span class="o">=</span> <span class="n">line</span>
					<span class="nf">.split</span><span class="p">(</span><span class="sc">'x'</span><span class="p">)</span>
					<span class="nf">.map</span><span class="p">(|</span><span class="n">n</span><span class="p">|</span> <span class="n">n</span><span class="py">.parse</span><span class="p">::</span><span class="o">&lt;</span><span class="nb">usize</span><span class="o">&gt;</span><span class="p">()</span><span class="nf">.unwrap</span><span class="p">())</span>
					<span class="py">.collect</span><span class="p">::</span><span class="o">&lt;</span><span class="nb">Vec</span><span class="o">&lt;</span><span class="n">_</span><span class="o">&gt;&gt;</span><span class="p">();</span>
		<span class="k">let</span> <span class="n">l</span> <span class="o">=</span> <span class="n">dims</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
		<span class="k">let</span> <span class="n">w</span> <span class="o">=</span> <span class="n">dims</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
		<span class="k">let</span> <span class="n">h</span> <span class="o">=</span> <span class="n">dims</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
		
		<span class="k">let</span> <span class="n">areas</span> <span class="o">=</span> <span class="nd">vec!</span><span class="p">[</span><span class="n">l</span><span class="o">*</span><span class="n">w</span><span class="p">,</span> <span class="n">l</span><span class="o">*</span><span class="n">h</span><span class="p">,</span> <span class="n">w</span><span class="o">*</span><span class="n">h</span><span class="p">];</span>
		<span class="k">let</span> <span class="n">perims</span> <span class="o">=</span> <span class="nd">vec!</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">l</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">w</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">l</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">h</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">w</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">h</span><span class="p">];</span>
		
		<span class="k">let</span> <span class="n">volume</span><span class="p">:</span> <span class="nb">usize</span> <span class="o">=</span> <span class="n">l</span><span class="o">*</span><span class="n">w</span><span class="o">*</span><span class="n">h</span><span class="p">;</span>
		<span class="k">let</span> <span class="n">min_area</span> <span class="o">=</span> <span class="n">areas</span><span class="nf">.into_iter</span><span class="p">()</span><span class="nf">.min</span><span class="p">();</span>
		<span class="k">let</span> <span class="n">sum_area</span> <span class="o">=</span> <span class="n">areas</span><span class="nf">.into_iter</span><span class="p">()</span><span class="nf">.sum</span><span class="p">();</span>
		<span class="k">let</span> <span class="n">min_perim</span> <span class="o">=</span> <span class="n">perims</span><span class="nf">.into_iter</span><span class="p">()</span><span class="nf">.min</span><span class="p">();</span>
		
		<span class="n">part1</span> <span class="o">+=</span> <span class="n">min_area</span><span class="p">;</span>
		<span class="n">part1</span> <span class="o">+=</span> <span class="n">sum_area</span><span class="p">;</span>
		<span class="n">part2</span> <span class="o">+=</span> <span class="n">min_perim</span><span class="p">;</span>
		<span class="n">part2</span> <span class="o">+=</span> <span class="n">volume</span><span class="p">;</span>
	<span class="p">}</span>
    <span class="nd">println!</span><span class="p">(</span><span class="s">"Part 1: {}"</span><span class="p">,</span> <span class="n">part1</span><span class="p">);</span>
    <span class="nd">println!</span><span class="p">(</span><span class="s">"Part 2: {}"</span><span class="p">,</span> <span class="n">part2</span><span class="p">);</span>
<span class="p">}</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>error[E0277]: cannot add-assign `Option&lt;usize&gt;` to `usize`

part1 += min_area;
      ^^ no implementation for `usize += Option&lt;usize&gt;`
</pre></table></code></div></div><p>I know I need <code class="language-plaintext highlighter-rouge">.unwrap()</code> at minimum (and even that’s the lazy way out; I should in practice be doing more detail error checking) for anything that returns a <code class="language-plaintext highlighter-rouge">Result</code>; I suppose I need to do the same thing for <code class="language-plaintext highlighter-rouge">Option</code>s. Since I’ve created the vectors myself, I know they’re not empty, so I don’t expect that to cause trouble. And I only have to do that for <code class="language-plaintext highlighter-rouge">.min()</code>; <code class="language-plaintext highlighter-rouge">.sum()</code> returns whatever type it was called on.</p><h2 id="attempt-12">Attempt 1.2</h2><div class="language-rust highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
</pre><td class="rouge-code"><pre><span class="k">use</span> <span class="nn">std</span><span class="p">::</span><span class="n">fs</span><span class="p">;</span>

<span class="k">fn</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
	<span class="k">let</span> <span class="n">file</span> <span class="o">=</span> <span class="s">"../Inputs/Day2Input.txt"</span><span class="p">;</span>
	<span class="k">let</span> <span class="n">input_raw</span><span class="p">:</span> <span class="nb">String</span> <span class="o">=</span> <span class="nn">fs</span><span class="p">::</span><span class="nf">read_to_string</span><span class="p">(</span><span class="n">file</span><span class="p">)</span><span class="nf">.unwrap</span><span class="p">();</span>
	<span class="k">let</span> <span class="n">lines</span> <span class="o">=</span> <span class="n">input_raw</span><span class="nf">.lines</span><span class="p">();</span>
	
	<span class="k">let</span> <span class="k">mut</span> <span class="n">part1</span><span class="p">:</span> <span class="nb">usize</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="k">let</span> <span class="k">mut</span> <span class="n">part2</span><span class="p">:</span> <span class="nb">usize</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="k">for</span> <span class="n">line</span> <span class="k">in</span> <span class="n">lines</span> <span class="p">{</span>
		<span class="k">let</span> <span class="n">dims</span> <span class="o">=</span> <span class="n">line</span>
					<span class="nf">.split</span><span class="p">(</span><span class="sc">'x'</span><span class="p">)</span>
					<span class="nf">.map</span><span class="p">(|</span><span class="n">n</span><span class="p">|</span> <span class="n">n</span><span class="py">.parse</span><span class="p">::</span><span class="o">&lt;</span><span class="nb">usize</span><span class="o">&gt;</span><span class="p">()</span><span class="nf">.unwrap</span><span class="p">())</span>
					<span class="py">.collect</span><span class="p">::</span><span class="o">&lt;</span><span class="nb">Vec</span><span class="o">&lt;</span><span class="n">_</span><span class="o">&gt;&gt;</span><span class="p">();</span>
		<span class="k">let</span> <span class="n">l</span> <span class="o">=</span> <span class="n">dims</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
		<span class="k">let</span> <span class="n">w</span> <span class="o">=</span> <span class="n">dims</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
		<span class="k">let</span> <span class="n">h</span> <span class="o">=</span> <span class="n">dims</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
		
		<span class="k">let</span> <span class="n">areas</span> <span class="o">=</span> <span class="nd">vec!</span><span class="p">[</span><span class="n">l</span><span class="o">*</span><span class="n">w</span><span class="p">,</span> <span class="n">l</span><span class="o">*</span><span class="n">h</span><span class="p">,</span> <span class="n">w</span><span class="o">*</span><span class="n">h</span><span class="p">];</span>
		<span class="k">let</span> <span class="n">perims</span> <span class="o">=</span> <span class="nd">vec!</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">l</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">w</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">l</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">h</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">w</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">h</span><span class="p">];</span>
		
		<span class="k">let</span> <span class="n">volume</span><span class="p">:</span> <span class="nb">usize</span> <span class="o">=</span> <span class="n">l</span><span class="o">*</span><span class="n">w</span><span class="o">*</span><span class="n">h</span><span class="p">;</span>
		<span class="k">let</span> <span class="n">min_area</span> <span class="o">=</span> <span class="n">areas</span><span class="nf">.into_iter</span><span class="p">()</span><span class="nf">.min</span><span class="p">()</span><span class="nf">.unwrap</span><span class="p">();</span>
		<span class="k">let</span> <span class="n">sum_area</span> <span class="o">=</span> <span class="n">areas</span><span class="nf">.into_iter</span><span class="p">()</span><span class="nf">.sum</span><span class="p">();</span>
		<span class="k">let</span> <span class="n">min_perim</span> <span class="o">=</span> <span class="n">perims</span><span class="nf">.into_iter</span><span class="p">()</span><span class="nf">.min</span><span class="p">()</span><span class="nf">.unwrap</span><span class="p">();</span>
		
		<span class="n">part1</span> <span class="o">+=</span> <span class="n">min_area</span><span class="p">;</span>
		<span class="n">part1</span> <span class="o">+=</span> <span class="n">sum_area</span><span class="p">;</span>
		<span class="n">part2</span> <span class="o">+=</span> <span class="n">min_perim</span><span class="p">;</span>
		<span class="n">part2</span> <span class="o">+=</span> <span class="n">volume</span><span class="p">;</span>
	<span class="p">}</span>
    <span class="nd">println!</span><span class="p">(</span><span class="s">"Part 1: {}"</span><span class="p">,</span> <span class="n">part1</span><span class="p">);</span>
    <span class="nd">println!</span><span class="p">(</span><span class="s">"Part 2: {}"</span><span class="p">,</span> <span class="n">part2</span><span class="p">);</span>
<span class="p">}</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>error[E0282]: type annotations needed

let sum_area = areas.into_iter().sum();
    ^^^^^^^^ consider giving `sum_area` a type
</pre></table></code></div></div><p>That’s unexpected; why was it fine with the types for <code class="language-plaintext highlighter-rouge">.min()</code> but not <code class="language-plaintext highlighter-rouge">.sum()</code>? Looking at <a href="https://doc.rust-lang.org/core/iter/trait.Iterator.html#method.min">the documentation for min</a> and <a href="https://doc.rust-lang.org/core/iter/trait.Iterator.html#method.sum">the documentation for sum</a>, the only difference I can see is that since I called <code class="language-plaintext highlighter-rouge">.unwrap()</code> on <code class="language-plaintext highlighter-rouge">.min()</code>, I got the inside of <code class="language-plaintext highlighter-rouge">Option&lt;Self::Item&gt;</code> (which was <code class="language-plaintext highlighter-rouge">Self::Item</code>), but <code class="language-plaintext highlighter-rouge">.sum()</code> returns <code class="language-plaintext highlighter-rouge">Sum&lt;Self::Item&gt;</code>. So, maybe Rust can’t infer a type from the inside of a structure.</p><h2 id="attempt-13">Attempt 1.3</h2><div class="language-rust highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
</pre><td class="rouge-code"><pre><span class="k">use</span> <span class="nn">std</span><span class="p">::</span><span class="n">fs</span><span class="p">;</span>

<span class="k">fn</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
	<span class="k">let</span> <span class="n">file</span> <span class="o">=</span> <span class="s">"../Inputs/Day2Input.txt"</span><span class="p">;</span>
	<span class="k">let</span> <span class="n">input_raw</span><span class="p">:</span> <span class="nb">String</span> <span class="o">=</span> <span class="nn">fs</span><span class="p">::</span><span class="nf">read_to_string</span><span class="p">(</span><span class="n">file</span><span class="p">)</span><span class="nf">.unwrap</span><span class="p">();</span>
	<span class="k">let</span> <span class="n">lines</span> <span class="o">=</span> <span class="n">input_raw</span><span class="nf">.lines</span><span class="p">();</span>
	
	<span class="k">let</span> <span class="k">mut</span> <span class="n">part1</span><span class="p">:</span> <span class="nb">usize</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="k">let</span> <span class="k">mut</span> <span class="n">part2</span><span class="p">:</span> <span class="nb">usize</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="k">for</span> <span class="n">line</span> <span class="k">in</span> <span class="n">lines</span> <span class="p">{</span>
		<span class="k">let</span> <span class="n">dims</span> <span class="o">=</span> <span class="n">line</span>
					<span class="nf">.split</span><span class="p">(</span><span class="sc">'x'</span><span class="p">)</span>
					<span class="nf">.map</span><span class="p">(|</span><span class="n">n</span><span class="p">|</span> <span class="n">n</span><span class="py">.parse</span><span class="p">::</span><span class="o">&lt;</span><span class="nb">usize</span><span class="o">&gt;</span><span class="p">()</span><span class="nf">.unwrap</span><span class="p">())</span>
					<span class="py">.collect</span><span class="p">::</span><span class="o">&lt;</span><span class="nb">Vec</span><span class="o">&lt;</span><span class="n">_</span><span class="o">&gt;&gt;</span><span class="p">();</span>
		<span class="k">let</span> <span class="n">l</span> <span class="o">=</span> <span class="n">dims</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
		<span class="k">let</span> <span class="n">w</span> <span class="o">=</span> <span class="n">dims</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
		<span class="k">let</span> <span class="n">h</span> <span class="o">=</span> <span class="n">dims</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
		
		<span class="k">let</span> <span class="n">areas</span> <span class="o">=</span> <span class="nd">vec!</span><span class="p">[</span><span class="n">l</span><span class="o">*</span><span class="n">w</span><span class="p">,</span> <span class="n">l</span><span class="o">*</span><span class="n">h</span><span class="p">,</span> <span class="n">w</span><span class="o">*</span><span class="n">h</span><span class="p">];</span>
		<span class="k">let</span> <span class="n">perims</span> <span class="o">=</span> <span class="nd">vec!</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">l</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">w</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">l</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">h</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">w</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">h</span><span class="p">];</span>
		
		<span class="k">let</span> <span class="n">volume</span><span class="p">:</span> <span class="nb">usize</span> <span class="o">=</span> <span class="n">l</span><span class="o">*</span><span class="n">w</span><span class="o">*</span><span class="n">h</span><span class="p">;</span>
		<span class="k">let</span> <span class="n">min_area</span> <span class="o">=</span> <span class="n">areas</span><span class="nf">.into_iter</span><span class="p">()</span><span class="nf">.min</span><span class="p">()</span><span class="nf">.unwrap</span><span class="p">();</span>
		<span class="k">let</span> <span class="n">sum_area</span><span class="p">:</span> <span class="nb">usize</span> <span class="o">=</span> <span class="n">areas</span><span class="nf">.into_iter</span><span class="p">()</span><span class="nf">.sum</span><span class="p">();</span>
		<span class="k">let</span> <span class="n">min_perim</span> <span class="o">=</span> <span class="n">perims</span><span class="nf">.into_iter</span><span class="p">()</span><span class="nf">.min</span><span class="p">()</span><span class="nf">.unwrap</span><span class="p">();</span>
		
		<span class="n">part1</span> <span class="o">+=</span> <span class="n">min_area</span><span class="p">;</span>
		<span class="n">part1</span> <span class="o">+=</span> <span class="n">sum_area</span><span class="p">;</span>
		<span class="n">part2</span> <span class="o">+=</span> <span class="n">min_perim</span><span class="p">;</span>
		<span class="n">part2</span> <span class="o">+=</span> <span class="n">volume</span><span class="p">;</span>
	<span class="p">}</span>
    <span class="nd">println!</span><span class="p">(</span><span class="s">"Part 1: {}"</span><span class="p">,</span> <span class="n">part1</span><span class="p">);</span>
    <span class="nd">println!</span><span class="p">(</span><span class="s">"Part 2: {}"</span><span class="p">,</span> <span class="n">part2</span><span class="p">);</span>
<span class="p">}</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre>error[E0382]: use of moved value: `areas`

25  |         let areas = vec![l*w, l*h, w*h];
    |             ----- move occurs because `areas` has type `Vec&lt;usize&gt;`, which does not implement the `Copy` trait
...
29  |         let min_area = areas.into_iter().min().unwrap();
    |                              ----------- `areas` moved due to this method call
30  |         let sum_area: usize = areas.into_iter().sum();
    |                               ^^^^^ value used here after move
</pre></table></code></div></div><p>The errors are getting more interesting now. Apparently <code class="language-plaintext highlighter-rouge">.into_iter()</code> actually moves the vector it’s calling; I had no idea, because I’ve so far never used it more than once on the same vector. I can think of two ways around this: find a way to create an iterator which does not move the vector in the process, or find a way to call both <code class="language-plaintext highlighter-rouge">.min()</code> and <code class="language-plaintext highlighter-rouge">.sum()</code> on the same iterator. I’ll try the first option first, calling <code class="language-plaintext highlighter-rouge">.iter()</code> instead of <code class="language-plaintext highlighter-rouge">.into_iter()</code> to see if that solves it.</p><h2 id="attempt-14">Attempt 1.4</h2><div class="language-rust highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
</pre><td class="rouge-code"><pre><span class="k">use</span> <span class="nn">std</span><span class="p">::</span><span class="n">fs</span><span class="p">;</span>

<span class="k">fn</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
	<span class="k">let</span> <span class="n">file</span> <span class="o">=</span> <span class="s">"../Inputs/Day2Input.txt"</span><span class="p">;</span>
	<span class="k">let</span> <span class="n">input_raw</span><span class="p">:</span> <span class="nb">String</span> <span class="o">=</span> <span class="nn">fs</span><span class="p">::</span><span class="nf">read_to_string</span><span class="p">(</span><span class="n">file</span><span class="p">)</span><span class="nf">.unwrap</span><span class="p">();</span>
	<span class="k">let</span> <span class="n">lines</span> <span class="o">=</span> <span class="n">input_raw</span><span class="nf">.lines</span><span class="p">();</span>
	
	<span class="k">let</span> <span class="k">mut</span> <span class="n">part1</span><span class="p">:</span> <span class="nb">usize</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="k">let</span> <span class="k">mut</span> <span class="n">part2</span><span class="p">:</span> <span class="nb">usize</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="k">for</span> <span class="n">line</span> <span class="k">in</span> <span class="n">lines</span> <span class="p">{</span>
		<span class="k">let</span> <span class="n">dims</span> <span class="o">=</span> <span class="n">line</span>
					<span class="nf">.split</span><span class="p">(</span><span class="sc">'x'</span><span class="p">)</span>
					<span class="nf">.map</span><span class="p">(|</span><span class="n">n</span><span class="p">|</span> <span class="n">n</span><span class="py">.parse</span><span class="p">::</span><span class="o">&lt;</span><span class="nb">usize</span><span class="o">&gt;</span><span class="p">()</span><span class="nf">.unwrap</span><span class="p">())</span>
					<span class="py">.collect</span><span class="p">::</span><span class="o">&lt;</span><span class="nb">Vec</span><span class="o">&lt;</span><span class="n">_</span><span class="o">&gt;&gt;</span><span class="p">();</span>
		<span class="k">let</span> <span class="n">l</span> <span class="o">=</span> <span class="n">dims</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
		<span class="k">let</span> <span class="n">w</span> <span class="o">=</span> <span class="n">dims</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
		<span class="k">let</span> <span class="n">h</span> <span class="o">=</span> <span class="n">dims</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
		
		<span class="k">let</span> <span class="n">areas</span> <span class="o">=</span> <span class="nd">vec!</span><span class="p">[</span><span class="n">l</span><span class="o">*</span><span class="n">w</span><span class="p">,</span> <span class="n">l</span><span class="o">*</span><span class="n">h</span><span class="p">,</span> <span class="n">w</span><span class="o">*</span><span class="n">h</span><span class="p">];</span>
		<span class="k">let</span> <span class="n">perims</span> <span class="o">=</span> <span class="nd">vec!</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">l</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">w</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">l</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">h</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">w</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">h</span><span class="p">];</span>
		
		<span class="k">let</span> <span class="n">volume</span><span class="p">:</span> <span class="nb">usize</span> <span class="o">=</span> <span class="n">l</span><span class="o">*</span><span class="n">w</span><span class="o">*</span><span class="n">h</span><span class="p">;</span>
		<span class="k">let</span> <span class="n">min_area</span> <span class="o">=</span> <span class="n">areas</span><span class="nf">.iter</span><span class="p">()</span><span class="nf">.min</span><span class="p">()</span><span class="nf">.unwrap</span><span class="p">();</span>
		<span class="k">let</span> <span class="n">sum_area</span><span class="p">:</span> <span class="nb">usize</span> <span class="o">=</span> <span class="n">areas</span><span class="nf">.into_iter</span><span class="p">()</span><span class="nf">.sum</span><span class="p">();</span>
		<span class="k">let</span> <span class="n">min_perim</span> <span class="o">=</span> <span class="n">perims</span><span class="nf">.into_iter</span><span class="p">()</span><span class="nf">.min</span><span class="p">()</span><span class="nf">.unwrap</span><span class="p">();</span>
		
		<span class="n">part1</span> <span class="o">+=</span> <span class="n">min_area</span><span class="p">;</span>
		<span class="n">part1</span> <span class="o">+=</span> <span class="n">sum_area</span><span class="p">;</span>
		<span class="n">part2</span> <span class="o">+=</span> <span class="n">min_perim</span><span class="p">;</span>
		<span class="n">part2</span> <span class="o">+=</span> <span class="n">volume</span><span class="p">;</span>
	<span class="p">}</span>
    <span class="nd">println!</span><span class="p">(</span><span class="s">"Part 1: {}"</span><span class="p">,</span> <span class="n">part1</span><span class="p">);</span>
    <span class="nd">println!</span><span class="p">(</span><span class="s">"Part 2: {}"</span><span class="p">,</span> <span class="n">part2</span><span class="p">);</span>
<span class="p">}</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre>error[E0505]: cannot move out of `areas` because it is borrowed
  --&gt; src/main.rs:30:25
   |
29 |         let min_area = areas.iter().min().unwrap();
   |                        ----- borrow of `areas` occurs here
30 |         let sum_area: usize = areas.into_iter().sum();
   |                               ^^^^^ move out of `areas` occurs here
...
33 |         part1 += min_area;
   |                  -------- borrow later used here
</pre></table></code></div></div><p>At long last, I’ve gotten yelled at by a borrow checker! So, it’s time to read up on <a href="https://doc.rust-lang.org/reference/expressions/operator-expr.html">what exactly a borrow checker is, and why it’s yelling at me</a>. A cursory read seems to say that when I call <code class="language-plaintext highlighter-rouge">.iter()</code> the first time, it operates on the <em>references</em> to the values while <code class="language-plaintext highlighter-rouge">.into_iter()</code> operates on the values directly. Since I don’t explicitly let go of the references in <code class="language-plaintext highlighter-rouge">.iter()</code>, when the borrow checker sees that <code class="language-plaintext highlighter-rouge">.into_iter()</code> calls the values that I’m potentially still referencing and moves them, it says that this is not acceptable, and tells me to knock it off.</p><p>The easy solution: call <code class="language-plaintext highlighter-rouge">.iter()</code> both times. Neither <code class="language-plaintext highlighter-rouge">.min()</code> nor <code class="language-plaintext highlighter-rouge">.sum()</code> needs to modify anything, so I have no problem with giving both immutable references to the same thing. Multiple functions getting immutable references to the same thing appeases the borrow checker; neither one can modify anything, so memory allocation is safe.</p><h2 id="final-version">Final Version</h2><div class="language-rust highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
</pre><td class="rouge-code"><pre><span class="k">use</span> <span class="nn">std</span><span class="p">::</span><span class="n">fs</span><span class="p">;</span>
<span class="k">use</span> <span class="nn">std</span><span class="p">::</span><span class="nn">time</span><span class="p">::{</span><span class="n">Instant</span><span class="p">};</span>

<span class="k">fn</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
	<span class="k">let</span> <span class="n">start</span> <span class="o">=</span> <span class="nn">Instant</span><span class="p">::</span><span class="nf">now</span><span class="p">();</span>
	
	<span class="k">let</span> <span class="n">file</span> <span class="o">=</span> <span class="s">"../Inputs/Day2Input.txt"</span><span class="p">;</span>
	<span class="k">let</span> <span class="n">input_raw</span><span class="p">:</span> <span class="nb">String</span> <span class="o">=</span> <span class="nn">fs</span><span class="p">::</span><span class="nf">read_to_string</span><span class="p">(</span><span class="n">file</span><span class="p">)</span><span class="nf">.unwrap</span><span class="p">();</span>
	<span class="k">let</span> <span class="n">lines</span> <span class="o">=</span> <span class="n">input_raw</span><span class="nf">.lines</span><span class="p">();</span>
	
	<span class="k">let</span> <span class="k">mut</span> <span class="n">part1</span><span class="p">:</span> <span class="nb">usize</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="k">let</span> <span class="k">mut</span> <span class="n">part2</span><span class="p">:</span> <span class="nb">usize</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="k">for</span> <span class="n">line</span> <span class="k">in</span> <span class="n">lines</span> <span class="p">{</span>
		<span class="k">let</span> <span class="n">dims</span> <span class="o">=</span> <span class="n">line</span>
					<span class="nf">.split</span><span class="p">(</span><span class="sc">'x'</span><span class="p">)</span>
					<span class="nf">.map</span><span class="p">(|</span><span class="n">n</span><span class="p">|</span> <span class="n">n</span><span class="py">.parse</span><span class="p">::</span><span class="o">&lt;</span><span class="nb">usize</span><span class="o">&gt;</span><span class="p">()</span><span class="nf">.unwrap</span><span class="p">())</span>
					<span class="py">.collect</span><span class="p">::</span><span class="o">&lt;</span><span class="nb">Vec</span><span class="o">&lt;</span><span class="n">_</span><span class="o">&gt;&gt;</span><span class="p">();</span>
		<span class="k">let</span> <span class="n">l</span> <span class="o">=</span> <span class="n">dims</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
		<span class="k">let</span> <span class="n">w</span> <span class="o">=</span> <span class="n">dims</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
		<span class="k">let</span> <span class="n">h</span> <span class="o">=</span> <span class="n">dims</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
		
		<span class="k">let</span> <span class="n">areas</span> <span class="o">=</span> <span class="nd">vec!</span><span class="p">[</span><span class="n">l</span><span class="o">*</span><span class="n">w</span><span class="p">,</span> <span class="n">l</span><span class="o">*</span><span class="n">h</span><span class="p">,</span> <span class="n">w</span><span class="o">*</span><span class="n">h</span><span class="p">];</span>
		<span class="k">let</span> <span class="n">perims</span> <span class="o">=</span> <span class="nd">vec!</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">l</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">w</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">l</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">h</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">w</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">h</span><span class="p">];</span>
		
		<span class="k">let</span> <span class="n">volume</span><span class="p">:</span> <span class="nb">usize</span> <span class="o">=</span> <span class="n">l</span><span class="o">*</span><span class="n">w</span><span class="o">*</span><span class="n">h</span><span class="p">;</span>
		<span class="k">let</span> <span class="n">min_area</span> <span class="o">=</span> <span class="n">areas</span><span class="nf">.iter</span><span class="p">()</span><span class="nf">.min</span><span class="p">()</span><span class="nf">.unwrap</span><span class="p">();</span>
		<span class="k">let</span> <span class="n">sum_area</span><span class="p">:</span> <span class="nb">usize</span> <span class="o">=</span> <span class="n">areas</span><span class="nf">.iter</span><span class="p">()</span><span class="nf">.sum</span><span class="p">();</span>
		<span class="k">let</span> <span class="n">min_perim</span> <span class="o">=</span> <span class="n">perims</span><span class="nf">.iter</span><span class="p">()</span><span class="nf">.min</span><span class="p">()</span><span class="nf">.unwrap</span><span class="p">();</span>
		
		<span class="n">part1</span> <span class="o">+=</span> <span class="n">min_area</span><span class="p">;</span>
		<span class="n">part1</span> <span class="o">+=</span> <span class="mi">2</span><span class="o">*</span><span class="n">sum_area</span><span class="p">;</span>
		<span class="n">part2</span> <span class="o">+=</span> <span class="n">min_perim</span><span class="p">;</span>
		<span class="n">part2</span> <span class="o">+=</span> <span class="n">volume</span><span class="p">;</span>
	<span class="p">}</span>
	
	<span class="k">let</span> <span class="n">end</span> <span class="o">=</span> <span class="n">start</span><span class="nf">.elapsed</span><span class="p">()</span><span class="nf">.as_micros</span><span class="p">();</span>
    <span class="nd">println!</span><span class="p">(</span><span class="s">"Part 1: {}"</span><span class="p">,</span> <span class="n">part1</span><span class="p">);</span>
    <span class="nd">println!</span><span class="p">(</span><span class="s">"Part 2: {}"</span><span class="p">,</span> <span class="n">part2</span><span class="p">);</span>
    <span class="nd">println!</span><span class="p">(</span><span class="s">"Time: {} μs"</span><span class="p">,</span> <span class="n">end</span><span class="p">);</span>
<span class="p">}</span>
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>Finished release [optimized] target(s) in 0.00s
 Running `target/release/day_2`
Part 1: 1606483
Part 2: 3842356
Time: 132 μs
</pre></table></code></div></div><p>And there it is - two more stars acquired. I’m fully aware that I don’t completely understand borrowing, ownership, and the distinction between reference and value just yet, but I think I’m making progress in that direction. The speedup from Mathematica was not as drastic today; Mathematica runs this in 50,000 μs, so Rust “only” gives a ~500-fold speedup; I don’t expect we’ll get to speedups of 10,000x or more until we get to the MD5 problems, but it’s still remarkable to see this kind of speed in action.</p><hr /><h1 id="felipe">Felipe</h1><p>Day 2 is the last day I completed in 2015. So from here on out its all new to me. (Well, that’s not totally true, I’ve discussed most problems in AoC with Dave at some point or another.) The problem itself is fairly basic, its one of the fundamental asks in software: take a list of things, and perform mathematical operations on them. Thinking about the problem at a base level, we’re going to want some kind of <code class="language-plaintext highlighter-rouge">for...each</code> loop that looks at each entry, and then does math on it. Looking at the input, it looks like none of the math involves anything more complex than numbers of length 2, so we’re likely not looking at any crazy math optimizations to speed things up. I do make note of the limited subset of inputs though, it feels like we might wind up doing something tricky with that.</p><h2 id="barebones-solution">Barebones Solution</h2><p>A barebones soluton looks something like this.</p><div class="language-rust highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
</pre><td class="rouge-code"><pre><span class="k">use</span> <span class="nn">std</span><span class="p">::</span><span class="nn">time</span><span class="p">::{</span><span class="n">Instant</span><span class="p">};</span>
<span class="k">use</span> <span class="nn">std</span><span class="p">::</span><span class="n">fs</span><span class="p">;</span>

<span class="k">fn</span> <span class="nf">main</span><span class="p">(){</span>
        <span class="k">let</span> <span class="n">file</span> <span class="o">=</span><span class="s">"../input.txt"</span><span class="p">;</span>
        <span class="k">let</span> <span class="n">input_string</span><span class="p">:</span> <span class="nb">String</span> <span class="o">=</span> <span class="nn">fs</span><span class="p">::</span><span class="nf">read_to_string</span><span class="p">(</span><span class="n">file</span><span class="p">)</span><span class="nf">.unwrap</span><span class="p">();</span>
        <span class="k">let</span> <span class="n">lines</span> <span class="o">=</span> <span class="n">input_string</span><span class="nf">.lines</span><span class="p">();</span>
        <span class="k">let</span> <span class="n">lines2</span> <span class="o">=</span> <span class="n">input_string</span><span class="nf">.lines</span><span class="p">();</span>

        <span class="k">let</span> <span class="n">start</span> <span class="o">=</span> <span class="nn">Instant</span><span class="p">::</span><span class="nf">now</span><span class="p">();</span>
        <span class="k">let</span> <span class="k">mut</span> <span class="n">day_2</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">let</span> <span class="k">mut</span> <span class="n">day_1</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">for</span> <span class="n">string</span> <span class="k">in</span> <span class="n">lines</span> <span class="p">{</span>
            <span class="k">let</span> <span class="k">mut</span> <span class="n">dimensions</span> <span class="o">=</span> <span class="n">string</span><span class="nf">.split</span><span class="p">(</span><span class="sc">'x'</span><span class="p">)</span>
            <span class="nf">.map</span><span class="p">(|</span><span class="n">n</span><span class="p">|</span> <span class="n">n</span><span class="py">.parse</span><span class="p">::</span><span class="o">&lt;</span><span class="nb">usize</span><span class="o">&gt;</span><span class="p">()</span><span class="nf">.unwrap</span><span class="p">())</span>
            <span class="py">.collect</span><span class="p">::</span><span class="o">&lt;</span><span class="nb">Vec</span><span class="o">&lt;</span><span class="n">_</span><span class="o">&gt;&gt;</span><span class="p">();</span>

            <span class="n">dimensions</span><span class="nf">.sort</span><span class="p">();</span>
            <span class="k">let</span> <span class="n">length</span> <span class="o">=</span> <span class="n">dimensions</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
            <span class="k">let</span> <span class="n">width</span> <span class="o">=</span> <span class="n">dimensions</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
            <span class="k">let</span> <span class="n">height</span> <span class="o">=</span> <span class="n">dimensions</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>

            <span class="k">let</span> <span class="n">volume</span><span class="p">:</span> <span class="nb">usize</span> <span class="o">=</span> <span class="n">length</span><span class="o">*</span><span class="n">width</span><span class="o">*</span><span class="n">height</span><span class="p">;</span>
            <span class="k">let</span> <span class="n">smallest_perimiter</span><span class="p">:</span> <span class="nb">usize</span> <span class="o">=</span> <span class="n">length</span><span class="o">*</span><span class="mi">2</span> <span class="o">+</span> <span class="n">width</span><span class="o">*</span><span class="mi">2</span><span class="p">;</span>
            <span class="k">let</span> <span class="n">surface_area</span><span class="p">:</span> <span class="nb">usize</span> <span class="o">=</span> <span class="p">(</span><span class="n">length</span><span class="o">*</span><span class="n">width</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">length</span><span class="o">*</span><span class="n">height</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">height</span><span class="o">*</span><span class="n">width</span><span class="o">*</span><span class="mi">2</span><span class="p">);</span>
            <span class="n">day_1</span> <span class="o">+=</span> <span class="n">surface_area</span> <span class="o">+</span> <span class="n">length</span><span class="o">*</span><span class="n">width</span><span class="p">;</span>

            <span class="n">day_2</span> <span class="o">+=</span> <span class="n">volume</span> <span class="o">+</span> <span class="n">smallest_perimiter</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="nd">print!</span><span class="p">(</span><span class="s">"day 2: {}"</span><span class="p">,</span> <span class="n">day_2</span><span class="p">);</span>
        <span class="nd">print!</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s"> day 1: {}"</span><span class="p">,</span> <span class="n">day_1</span><span class="p">);</span>
        <span class="k">let</span> <span class="n">end</span> <span class="o">=</span> <span class="n">start</span><span class="nf">.elapsed</span><span class="p">()</span><span class="nf">.as_micros</span><span class="p">();</span>
        <span class="nd">print!</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s"> execution time in microseconds {}"</span><span class="p">,</span> <span class="n">end</span><span class="p">);</span>
<span class="p">}</span>
</pre></table></code></div></div><p>Note that this is optimzied from my first pass solution which used two loops. It made sense to roll part 1 into part 2. The only slightly tricky optimization I do in this first pass is sorting the list of dimensions, so that length and width are always the smallest. It avoids us having to do extra computations and take the minimum, or having a bunch of if statements to replicate the sort. Since the list is only length three, it should be relatively quick. After the fact Dave and I compared our code and found that sorting was about as time consuming as taking the minimum twice, which is what his code does.</p><p>I looked at this, and I was pretty satisifed with my solution. It ran in 331 microseconds (not counting the file time), and produced the correct answers. Certainly much faster than almost any interpreted language, and a fairly neat solution.</p><p>A brief digression on timing here. You may have noticed Dave consistently gets better times than I do. We did a little testing, it turns out that <code class="language-plaintext highlighter-rouge">cargo run --release</code> has different perfomance profiles on different OS. I’m running on Windows, Dave is running on linux, and my solutions run much faster on his machine than mine, despite similar hardware profiles. I tested on a really crummy linux box, and it was about 100% faster to run than on Windows. Out of curiosity we also tested on a Mac and found it ran even slower, so it’s evident that for some reason rust is much more performant on linux. We’re planning to talk about this further in a later post after we run some tests.</p><h2 id="byte-parsing">Byte Parsing</h2><p>Returning to the problem at hand, I wondered though, if this being rust, we couldn’t get into the weeds, and do something to speed things up.</p><div class="language-rust highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="k">let</span> <span class="k">mut</span> <span class="n">dimensions</span> <span class="o">=</span> <span class="n">string</span><span class="nf">.split</span><span class="p">(</span><span class="sc">'x'</span><span class="p">)</span>
            <span class="nf">.map</span><span class="p">(|</span><span class="n">n</span><span class="p">|</span> <span class="n">n</span><span class="py">.parse</span><span class="p">::</span><span class="o">&lt;</span><span class="nb">usize</span><span class="o">&gt;</span><span class="p">()</span><span class="nf">.unwrap</span><span class="p">())</span>
            <span class="py">.collect</span><span class="p">::</span><span class="o">&lt;</span><span class="nb">Vec</span><span class="o">&lt;</span><span class="n">_</span><span class="o">&gt;&gt;</span><span class="p">();</span>
</pre></table></code></div></div><p>This block in particular looked supicious to me. Reading the file as a string wasn’t a big lift for rust, after all, strings are just collections of bytes, but parsing the bytes into groups and ensuring you translate any multi-byte characters correctly (like emojis) does take up some headroom. Further, we then had to perform a split operation and convert stings to integers, which I was convinced was a major time sink.</p><p>What then, if we just took our string, which is a byte array, and parsed it by hand. Usually you need a lot of saftey around these operations because you could have any arbitrary input, but we control our input here, we know its going to be only numbers, and the “x” character. No emojis, chinese characters, umlauts or escaped characters. If we did not control our input, this would be a recipie for disaster. I was convinced this wouldn’t <em>actually</em> save time, given that rust is already very efficient, and that inbuilt methods tend to be pretty good. Still I was looking for an excuse to get into the weeds (or the bytes in this case), and I figured a simple solution wouldn’t take that long.</p><div class="language-rust highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
</pre><td class="rouge-code"><pre><span class="k">use</span> <span class="nn">std</span><span class="p">::</span><span class="nn">time</span><span class="p">::{</span><span class="n">Instant</span><span class="p">};</span>
<span class="k">use</span> <span class="nn">std</span><span class="p">::</span><span class="n">fs</span><span class="p">;</span>

<span class="k">fn</span> <span class="nf">main</span><span class="p">(){</span>
        <span class="k">let</span> <span class="n">file</span> <span class="o">=</span><span class="s">"../input.txt"</span><span class="p">;</span>
        <span class="k">let</span> <span class="n">input_string</span><span class="p">:</span> <span class="nb">String</span> <span class="o">=</span> <span class="nn">fs</span><span class="p">::</span><span class="nf">read_to_string</span><span class="p">(</span><span class="n">file</span><span class="p">)</span><span class="nf">.unwrap</span><span class="p">();</span>
        <span class="k">let</span> <span class="n">lines</span> <span class="o">=</span> <span class="n">input_string</span><span class="nf">.lines</span><span class="p">();</span>
        <span class="k">let</span> <span class="n">lines2</span> <span class="o">=</span> <span class="n">input_string</span><span class="nf">.lines</span><span class="p">();</span>

        
        <span class="k">let</span> <span class="k">mut</span> <span class="n">day_2</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">let</span> <span class="k">mut</span> <span class="n">day_1</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">let</span> <span class="n">start</span> <span class="o">=</span> <span class="nn">Instant</span><span class="p">::</span><span class="nf">now</span><span class="p">();</span>
        <span class="k">for</span> <span class="n">string</span> <span class="k">in</span> <span class="n">lines</span> <span class="p">{</span>
            <span class="k">let</span> <span class="n">byte_dimensions</span> <span class="o">=</span> <span class="n">string</span><span class="nf">.as_bytes</span><span class="p">();</span>
            <span class="k">let</span> <span class="k">mut</span> <span class="n">dimensions</span> <span class="o">=</span> <span class="nd">vec!</span><span class="p">[];</span>
            <span class="k">let</span> <span class="k">mut</span> <span class="n">num</span> <span class="o">=</span> <span class="nd">vec!</span><span class="p">[];</span>
            
            <span class="k">for</span> <span class="n">byte</span> <span class="k">in</span> <span class="n">byte_dimensions</span> <span class="p">{</span>
  
                <span class="k">if</span><span class="p">(</span><span class="o">*</span><span class="n">byte</span> <span class="o">==</span> <span class="mi">120u8</span><span class="p">){</span>
                    <span class="k">let</span> <span class="k">mut</span> <span class="n">final_num</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
                    <span class="k">for</span> <span class="n">b</span> <span class="k">in</span> <span class="n">num</span><span class="nf">.iter</span><span class="p">(){</span>
                        <span class="n">final_num</span> <span class="o">=</span> <span class="n">final_num</span> <span class="o">*</span> <span class="mi">10u8</span> <span class="o">+</span> <span class="n">b</span><span class="p">;</span>
                    <span class="p">}</span>
                    <span class="n">dimensions</span><span class="nf">.push</span><span class="p">(</span><span class="n">final_num</span><span class="p">);</span>
                    <span class="n">num</span> <span class="o">=</span> <span class="nd">vec!</span><span class="p">[];</span>
                <span class="p">}</span><span class="k">else</span><span class="p">{</span>
                    <span class="n">num</span><span class="nf">.push</span><span class="p">(</span><span class="o">*</span><span class="n">byte</span><span class="o">-</span><span class="mi">48</span><span class="p">);</span>
                <span class="p">}</span>
                
            <span class="p">}</span>
            <span class="k">let</span> <span class="k">mut</span> <span class="n">final_num</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
            <span class="k">for</span> <span class="n">b</span> <span class="k">in</span> <span class="n">num</span><span class="nf">.iter</span><span class="p">(){</span>
                <span class="n">final_num</span> <span class="o">=</span> <span class="n">final_num</span> <span class="o">*</span> <span class="mi">10u8</span> <span class="o">+</span> <span class="n">b</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="n">dimensions</span><span class="nf">.push</span><span class="p">(</span><span class="n">final_num</span><span class="p">);</span>
            <span class="n">num</span> <span class="o">=</span> <span class="nd">vec!</span><span class="p">[];</span>

            <span class="n">dimensions</span><span class="nf">.sort</span><span class="p">();</span>
            <span class="k">let</span> <span class="n">length</span> <span class="o">=</span> <span class="n">dimensions</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">as</span> <span class="nb">u64</span><span class="p">;</span>
            <span class="k">let</span> <span class="n">width</span> <span class="o">=</span> <span class="n">dimensions</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">as</span> <span class="nb">u64</span><span class="p">;</span>
            <span class="k">let</span> <span class="n">height</span> <span class="o">=</span> <span class="n">dimensions</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="k">as</span> <span class="nb">u64</span><span class="p">;</span>

            <span class="k">let</span> <span class="n">volume</span><span class="p">:</span> <span class="nb">u64</span> <span class="o">=</span> <span class="n">length</span><span class="o">*</span><span class="n">width</span><span class="o">*</span><span class="n">height</span><span class="p">;</span>
            <span class="k">let</span> <span class="n">smallest_perimiter</span><span class="p">:</span> <span class="nb">u64</span> <span class="o">=</span> <span class="n">length</span><span class="o">*</span><span class="mi">2</span> <span class="o">+</span> <span class="n">width</span><span class="o">*</span><span class="mi">2</span><span class="p">;</span>

            <span class="n">day_2</span> <span class="o">+=</span> <span class="n">volume</span> <span class="o">+</span> <span class="n">smallest_perimiter</span><span class="p">;</span>
            <span class="k">let</span> <span class="n">surface_area</span><span class="p">:</span> <span class="nb">u64</span> <span class="o">=</span> <span class="p">(</span><span class="n">length</span><span class="o">*</span><span class="n">width</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">length</span><span class="o">*</span><span class="n">height</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">height</span><span class="o">*</span><span class="n">width</span><span class="o">*</span><span class="mi">2</span><span class="p">);</span>
            <span class="n">day_1</span> <span class="o">+=</span> <span class="n">surface_area</span> <span class="o">+</span> <span class="n">length</span><span class="o">*</span><span class="n">width</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="nd">print!</span><span class="p">(</span><span class="s">"day 1: {} day 2: {}"</span><span class="p">,</span> <span class="n">day_1</span><span class="p">,</span> <span class="n">day_2</span><span class="p">);</span>
        <span class="k">let</span> <span class="n">end</span> <span class="o">=</span> <span class="n">start</span><span class="nf">.elapsed</span><span class="p">()</span><span class="nf">.as_micros</span><span class="p">();</span>
        <span class="nd">print!</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s"> execution time in microseconds {}"</span><span class="p">,</span> <span class="n">end</span><span class="p">);</span>
<span class="p">}</span>
</pre></table></code></div></div><p>Getting there was slightly more involved than I expected. Basically the byte representation of each number is simply its byte value minus 48 (good to know for those annoying algorithm problems that sometimes show up in intervews!), and we knew no number was going to be longer than 2 characters in length, so we could handle both cases with relative ease. Our delimiter character is an “x” which in bytecode is represented by the number 120, and since we’re reading line by line, we have to parse the last number, which won’t end with an “x” after we’ve calcuated the first two.</p><p>To whit, we scan the bytes, and if they’re numbers we put them in a “number array” which is our representation of the number, if it’s an “x” we interpret this array to form a number and shove it into the dimensions array, and when we reach the end of the line we wrap up the last number.</p><p>Another consideration is we have to recast our sum to be u64 or we’ll overflow the variable and wind up with incorrect numbers.</p><p>Other than that, the code is exactly the same as our first pass.</p><p>Obviously, adding all this overhead should have cost us time, right? We’re initalizing arrays, pushing values, merging bytes, this feels like it should be less efficient. Somehow, it isn’t. Our runtime for this code was 300 microseconds, to the 330 microseconds of the first appreoach, an almost 10% speedup. Safety costs time, and by stripping it out we increased the perfomance of our code!</p><h2 id="byte-file-reader">Byte File Reader</h2><p>From here, it made natural sense to just skip the conversion to a string at all. Rust can very capably read the whole file from end to end as bytes (since strings are just byte arrays), and we can parse the whole string of bytes, saving us the need to split by lines, or even use any inbuilt character parsing.</p><div class="language-rust highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
</pre><td class="rouge-code"><pre><span class="k">use</span> <span class="nn">std</span><span class="p">::</span><span class="nn">time</span><span class="p">::{</span><span class="n">Instant</span><span class="p">};</span>
<span class="k">use</span> <span class="nn">std</span><span class="p">::</span><span class="nn">io</span><span class="p">::</span><span class="nn">prelude</span><span class="p">::</span><span class="o">*</span><span class="p">;</span>
<span class="k">use</span> <span class="nn">std</span><span class="p">::</span><span class="nn">fs</span><span class="p">::</span><span class="n">File</span><span class="p">;</span>

<span class="k">fn</span> <span class="nf">file_reader</span><span class="p">(</span><span class="n">path</span><span class="p">:</span><span class="o">&amp;</span><span class="nb">str</span><span class="p">)</span> <span class="k">-&gt;</span> <span class="nb">Vec</span><span class="o">&lt;</span><span class="nb">u8</span><span class="o">&gt;</span><span class="p">{</span>
    <span class="k">let</span> <span class="n">f</span> <span class="o">=</span> <span class="nn">File</span><span class="p">::</span><span class="nf">open</span><span class="p">(</span><span class="n">path</span><span class="p">);</span>
    <span class="k">let</span> <span class="k">mut</span> <span class="n">buffer</span> <span class="o">=</span> <span class="nn">Vec</span><span class="p">::</span><span class="nf">new</span><span class="p">();</span>
    <span class="k">let</span> <span class="k">mut</span> <span class="n">file</span><span class="p">:</span><span class="n">File</span><span class="p">;</span>
    <span class="k">match</span> <span class="n">f</span> <span class="p">{</span>
        <span class="nf">Ok</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">=&gt;</span> <span class="n">file</span> <span class="o">=</span> <span class="n">v</span><span class="p">,</span>
        <span class="nf">Err</span><span class="p">(</span><span class="n">e</span><span class="p">)</span> <span class="k">=&gt;</span> <span class="nd">panic!</span><span class="p">(</span><span class="s">"error: {:?}"</span><span class="p">,</span> <span class="n">e</span><span class="p">),</span>
    <span class="p">}</span>

    <span class="c1">// read the whole file</span>
    <span class="k">let</span> <span class="n">res</span> <span class="o">=</span> <span class="n">file</span><span class="nf">.read_to_end</span><span class="p">(</span><span class="o">&amp;</span><span class="k">mut</span> <span class="n">buffer</span><span class="p">);</span>
    <span class="k">match</span> <span class="n">res</span> <span class="p">{</span>
        <span class="nf">Ok</span><span class="p">(</span><span class="n">_</span><span class="p">)</span> <span class="k">=&gt;</span> <span class="k">return</span> <span class="n">buffer</span><span class="p">,</span>
        <span class="nf">Err</span><span class="p">(</span><span class="n">e</span><span class="p">)</span> <span class="k">=&gt;</span> <span class="nd">panic!</span><span class="p">(</span><span class="s">"error: {:?}"</span><span class="p">,</span> <span class="n">e</span><span class="p">),</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">fn</span> <span class="nf">main</span><span class="p">(){</span>
        <span class="k">let</span> <span class="n">start</span> <span class="o">=</span> <span class="nn">Instant</span><span class="p">::</span><span class="nf">now</span><span class="p">();</span>
        <span class="k">let</span> <span class="n">file</span> <span class="o">=</span><span class="s">"../input.txt"</span><span class="p">;</span>
        <span class="k">let</span> <span class="n">byte_buffer</span> <span class="o">=</span> <span class="nf">file_reader</span><span class="p">(</span><span class="n">file</span><span class="p">);</span>

        <span class="k">let</span> <span class="k">mut</span> <span class="n">day_2</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">let</span> <span class="k">mut</span> <span class="n">day_1</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">let</span> <span class="k">mut</span> <span class="n">dimensions</span> <span class="o">=</span> <span class="nd">vec!</span><span class="p">[];</span>
        <span class="k">let</span> <span class="k">mut</span> <span class="n">num</span> <span class="o">=</span> <span class="nd">vec!</span><span class="p">[];</span>
        <span class="k">for</span> <span class="n">byte</span> <span class="k">in</span> <span class="n">byte_buffer</span> <span class="p">{</span>
            
            <span class="k">if</span> <span class="n">byte</span> <span class="o">==</span> <span class="mi">120u8</span> <span class="p">||</span> <span class="n">byte</span> <span class="o">==</span> <span class="mi">10u8</span> <span class="p">{</span>
                <span class="k">let</span> <span class="k">mut</span> <span class="n">final_num</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
                <span class="k">for</span> <span class="n">b</span> <span class="k">in</span> <span class="n">num</span><span class="nf">.iter</span><span class="p">(){</span>
                    <span class="n">final_num</span> <span class="o">=</span> <span class="n">final_num</span> <span class="o">*</span> <span class="mi">10u8</span> <span class="o">+</span> <span class="n">b</span><span class="p">;</span>
                <span class="p">}</span>
                <span class="n">dimensions</span><span class="nf">.push</span><span class="p">(</span><span class="n">final_num</span><span class="p">);</span>
                <span class="n">num</span> <span class="o">=</span> <span class="nd">vec!</span><span class="p">[];</span>
            <span class="p">}</span><span class="k">else</span><span class="p">{</span>
                <span class="n">num</span><span class="nf">.push</span><span class="p">(</span><span class="n">byte</span><span class="o">-</span><span class="mi">48</span><span class="p">);</span>
            <span class="p">}</span>
              
            <span class="k">if</span> <span class="n">byte</span> <span class="o">==</span> <span class="mi">10u8</span> <span class="p">{</span>
                <span class="n">dimensions</span><span class="nf">.sort</span><span class="p">();</span>
                <span class="k">let</span> <span class="n">length</span> <span class="o">=</span> <span class="n">dimensions</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">as</span> <span class="nb">u64</span><span class="p">;</span>
                <span class="k">let</span> <span class="n">width</span> <span class="o">=</span> <span class="n">dimensions</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">as</span> <span class="nb">u64</span><span class="p">;</span>
                <span class="k">let</span> <span class="n">height</span> <span class="o">=</span> <span class="n">dimensions</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="k">as</span> <span class="nb">u64</span><span class="p">;</span>

                <span class="k">let</span> <span class="n">volume</span><span class="p">:</span> <span class="nb">u64</span> <span class="o">=</span> <span class="n">length</span><span class="o">*</span><span class="n">width</span><span class="o">*</span><span class="n">height</span><span class="p">;</span>
                <span class="k">let</span> <span class="n">smallest_perimiter</span><span class="p">:</span> <span class="nb">u64</span> <span class="o">=</span> <span class="n">length</span><span class="o">*</span><span class="mi">2</span> <span class="o">+</span> <span class="n">width</span><span class="o">*</span><span class="mi">2</span><span class="p">;</span>

                <span class="n">day_2</span> <span class="o">+=</span> <span class="n">volume</span> <span class="o">+</span> <span class="n">smallest_perimiter</span><span class="p">;</span>
                <span class="k">let</span> <span class="n">surface_area</span><span class="p">:</span> <span class="nb">u64</span> <span class="o">=</span> <span class="p">(</span><span class="n">length</span><span class="o">*</span><span class="n">width</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">length</span><span class="o">*</span><span class="n">height</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">height</span><span class="o">*</span><span class="n">width</span><span class="o">*</span><span class="mi">2</span><span class="p">);</span>
                <span class="n">day_1</span> <span class="o">+=</span> <span class="n">surface_area</span> <span class="o">+</span> <span class="n">length</span><span class="o">*</span><span class="n">width</span><span class="p">;</span>
                <span class="n">dimensions</span> <span class="o">=</span> <span class="nd">vec!</span><span class="p">[]</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="nd">print!</span><span class="p">(</span><span class="s">"day 1: {} day 2: {}"</span><span class="p">,</span> <span class="n">day_1</span><span class="p">,</span> <span class="n">day_2</span><span class="p">);</span>
        <span class="k">let</span> <span class="n">end</span> <span class="o">=</span> <span class="n">start</span><span class="nf">.elapsed</span><span class="p">()</span><span class="nf">.as_micros</span><span class="p">();</span>
        <span class="nd">print!</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s"> execution time in microseconds {}"</span><span class="p">,</span> <span class="n">end</span><span class="p">);</span>
<span class="p">}</span>
</pre></table></code></div></div><p>The primary change is that instead of reading each line, we scan for the line break character, “\n” represented by the number 10. This lets us know we’ve hit the end of a line and can do the requisite math. The logic for checking for x’s and putting our numbers together remains the same, and the cleanup logic just moves into the block that looks for the linebreak character.</p><p>To me, this is much easier to read than our second pass. Its also faster, it runs in 263 microseconds, almost 20% faster than our original solution. It also opens the file just one single microsecond faster, which suggests there’s not much of a time gain to be made in the file opening bit, at least not unless we really want to get our hands dirty…</p><p>There is a lesson to take away here, from the point of view of our desire to write the fastest code possible: more often than not, inbuilt methods include a lot of security precautions we don’t need at all. If we can control our input, writing our own parsing will more often than not be faster.</p><p>This is not the last time we’ll be seeing bytes, or byte arrays.</p><p>Join us next time where we try to use datastructures in ways they were never intended.</p></div><div class="post-content"><h3>Series</h3><li><a href="/posts/advent-of-code-2015-rust-day-1/">Learning Rust with Advent of Code - Day 1</a><li><b>Learning Rust with Advent of Code - Day 2</b><li><a href="/posts/advent-of-code-2015-rust-day-3/">Learning Rust with Advent of Code - Day 3</a><li><a href="/posts/advent-of-code-2015-rust-day-4/">Learning Rust with Advent of Code - Day 4</a><li><a href="/posts/advent-of-code-2015-rust-day-5/">Learning Rust with Advent of Code - Day 5</a><li><a href="/posts/advent-of-code-2015-rust-day-6/">Learning Rust with Advent of Code - Day 6</a></div><hr><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/programming/'>Programming</a>, <a href='/categories/advent-of-code/'>Advent of Code</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/programming/" class="post-tag no-text-decoration" >programming</a> <a href="/tags/rust/" class="post-tag no-text-decoration" >rust</a> <a href="/tags/david/" class="post-tag no-text-decoration" >david</a> <a href="/tags/felipe/" class="post-tag no-text-decoration" >felipe</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Learning Rust with Advent of Code - Day 2 - Hall of Impossible Dreams&url=http://hallofdreams.org/posts/advent-of-code-2015-rust-day-2/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Learning Rust with Advent of Code - Day 2 - Hall of Impossible Dreams&u=http://hallofdreams.org/posts/advent-of-code-2015-rust-day-2/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Learning Rust with Advent of Code - Day 2 - Hall of Impossible Dreams&url=http://hallofdreams.org/posts/advent-of-code-2015-rust-day-2/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="disqus" class="pt-2 pb-2"><p class="font-italic text-center text-muted small"> Comments powered by <a href="https://giscus.app">giscus</a>.</p></div><script src="https://giscus.app/client.js" data-repo="thecog19/blog-comments-giscus" data-repo-id="R_kgDOH0cdtg" data-category="Announcements" data-category-id="DIC_kwDOH0cdts4CQ02w" data-mapping="pathname" data-strict="0" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="bottom" data-theme="preferred_color_scheme" data-lang="en" data-loading="lazy" crossorigin="anonymous" async> </script></div></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script> <script type="text/javascript"> const imgs = document.querySelectorAll('#post-wrapper img'); const observer = lozad(imgs); observer.observe(); </script><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2025 <a href="https://twitter.com/thecog19">Dave and Felipe</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy/" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-xl-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/david/">david</a> <a class="post-tag" href="/tags/felipe/">felipe</a> <a class="post-tag" href="/tags/programming/">programming</a> <a class="post-tag" href="/tags/fiction/">fiction</a> <a class="post-tag" href="/tags/rust/">rust</a> <a class="post-tag" href="/tags/writing-prompts/">writing prompts</a> <a class="post-tag" href="/tags/poetry/">poetry</a> <a class="post-tag" href="/tags/essay/">essay</a> <a class="post-tag" href="/tags/mathematica/">mathematica</a> <a class="post-tag" href="/tags/hatetris/">hatetris</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="http://hallofdreams.org{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"><div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>{categories}</div><div><i class="fa fa-tag fa-fw"></i>{tags}</div></div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>' }); </script> <script async src="https://www.googletagmanager.com/gtag/js?id=183607258"></script> <script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', '183607258'); </script>
